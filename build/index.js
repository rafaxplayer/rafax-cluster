(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,a=window.wp.primitives,l=(0,t.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(a.Path,{d:"m3 5c0-1.10457.89543-2 2-2h13.5c1.1046 0 2 .89543 2 2v13.5c0 1.1046-.8954 2-2 2h-13.5c-1.10457 0-2-.8954-2-2zm2-.5h6v6.5h-6.5v-6c0-.27614.22386-.5.5-.5zm-.5 8v6c0 .2761.22386.5.5.5h6v-6.5zm8 0v6.5h6c.2761 0 .5-.2239.5-.5v-6zm0-8v6.5h6.5v-6c0-.27614-.2239-.5-.5-.5z",fillRule:"evenodd",clipRule:"evenodd"})),{ToolbarGroup:r,ToolbarDropdownMenu:n,ToolbarButton:o,SelectControl:s,Spinner:c}=wp.components,{BlockControls:i}=wp.blockEditor,u=({label:e})=>(0,t.createElement)("div",{className:"rafax-cluster-spinner"},(0,t.createElement)(c,null),e),d=({setAttributes:e})=>(0,t.createElement)(i,null,(0,t.createElement)(r,null,(0,t.createElement)(n,{icon:l,label:"Estilo Grid",controls:[{title:"Grid cols 2",onClick:()=>e({styleGrid:"grid-cols-2"})},{title:"Grid cols 3",onClick:()=>e({styleGrid:"grid-cols-3"})},{title:"Grid cols 4",onClick:()=>e({styleGrid:"grid-cols-4"})}]}))),p=({categories:e,label:a,help:l,disabled:r,value:n,defaultItem:o,onChange:c})=>{let i=[];return null!==e&&(i=e.map((e=>({label:e.name,value:e.id})))),(0,t.createElement)(s,{label:a,help:l,value:n,disabled:r,options:[o,...i],onChange:c,__nextHasNoMarginBottom:!0})},g=(0,t.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(a.Path,{d:"m7.3 9.7 1.4 1.4c.2-.2.3-.3.4-.5 0 0 0-.1.1-.1.3-.5.4-1.1.3-1.6L12 7 9 4 7.2 6.5c-.6-.1-1.1 0-1.6.3 0 0-.1 0-.1.1-.3.1-.4.2-.6.4l1.4 1.4L4 11v1h1l2.3-2.3zM4 20h9v-1.5H4V20zm0-5.5V16h16v-1.5H4z"})),m=window.wp.serverSideRender;var b=e.n(m);const{registerBlockType:h}=wp.blocks,{withSelect:x}=wp.data,{Fragment:f}=wp.element,{__}=wp.i18n,{PanelBody:v,Spinner:y,Placeholder:E,ToggleControl:w,SelectControl:C,FormTokenField:_,Disabled:B,RangeControl:P}=wp.components,{InspectorControls:k}=wp.blockEditor;h("rafax/cluster-entradas",{title:__("Rafax Cluster Entradas","rafax-cluster"),icon:{src:g},category:"rafax-blocks",attributes:{showFeaturedImage:{type:"boolean",default:!0},contentType:{type:"string",default:"post"},parentPage:{type:"number",default:0},includePosts:{type:"array",default:[]},excludePosts:{type:"array",default:[]},category:{type:"string",default:"all"},numberPosts:{type:"string",default:6},orderBy:{type:"string",default:"date"},order:{type:"string",default:"DESC"},styleGrid:{type:"string",default:"grid-cols-3"},typeSelect:{type:"string",default:"1"}},edit:x(((e,{clientId:t})=>{const a=e("core"),l=e("core/block-editor"),{attributes:r}=l.getBlock(t),n=r.contentType||"post";return{categories:a.getEntityRecords("taxonomy","category",{per_page:-1}),allPosts:a.getEntityRecords("postType",n,{per_page:r.numberPosts})}}))((({categories:e,allPosts:a,attributes:l,setAttributes:r})=>{const n=()=>{r({includePosts:[],excludePosts:[],category:"all",numberPosts:"100",parentPage:0})},o=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/<[^>]+>/g,"").trim(),s=!e||!a,{excludePosts:c,includePosts:i,showFeaturedImage:g,typeSelect:m,numberPosts:h,order:x,orderBy:y,category:M,parentPage:S,contentType:H}=l;let N=[],I=[],T=[],z={};return null!==a&&(N=a?.map((e=>o(e.title.raw))),z=a.reduce(((e,t)=>(e[t.id]=t,e)),{}),I=c?.map((e=>{let t=z[e];return!!t&&o(t.title.raw)})),T=i?.map((e=>{let t=z[e];return!!t&&o(t.title.raw)}))),(0,t.createElement)(f,null,(0,t.createElement)(d,{setAttributes:r}),(0,t.createElement)(k,null,(0,t.createElement)(v,{title:__("Opciones","rafax-cluster"),initialOpen:!0},(0,t.createElement)(w,{label:__("Mostrar Imagen Destacada","rafax-cluster"),checked:g,onChange:e=>r({showFeaturedImage:e}),__nextHasNoMarginBottom:!0}),(0,t.createElement)(C,{label:__("Tipo de contenido","rafax-cluster"),value:H,options:[{label:__("Entradas","rafax-cluster"),value:"post"},{label:__("Páginas","rafax-cluster"),value:"page"}],onChange:e=>{r({contentType:e}),n(),"page"===e&&"2"===m&&r({typeSelect:"1"})}}),";",(0,t.createElement)(C,{label:__("Tipo de seleccion","rafax-cluster"),value:m,options:[{label:"Últimas entradas o paginas",value:"1"},..."post"===H?[{label:"Entradas de una categoría",value:"2"}]:[{label:"Pagina padre",value:"4"}],{label:"Elegir entradas o paginas",value:"3"}],onChange:e=>{n(),r({typeSelect:e})},__nextHasNoMarginBottom:!0}),"page"===H&&"4"==m&&(0,t.createElement)(C,{label:__("Seleccionar página padre","rafax-cluster"),value:S,options:[{label:__("Ninguna","rafax-cluster"),value:0},...a?a.map((e=>({label:o(e.title.rendered),value:e.id}))):[]],onChange:e=>r({parentPage:parseInt(e,10)}),__nextHasNoMarginBottom:!0}),"3"===m&&(0,t.createElement)(_,{label:__("Mostrar solo estas entradas o paginas","rafax-cluster"),value:T,suggestions:N,placeholder:__("Busca las entradas que quieras mostrar","rafax-cluster"),onChange:e=>{const t=e.map((e=>{const t=a.find((t=>o(t.title.raw)===o(e)));return t?t.id:null})).filter(Boolean);r({includePosts:t})},__nextHasNoMarginBottom:!0}),("1"===m||"2"===m)&&(0,t.createElement)(P,{label:__("Numero de posts","rafax-cluster"),value:parseInt(h),onChange:e=>r({numberPosts:String(e)}),min:1,max:100,__nextHasNoMarginBottom:!0}),"1"===l.typeSelect&&(0,t.createElement)(_,{label:__("Excluir entradas o paginas","rafax-cluster"),value:I,suggestions:N,placeholder:__("Busca las entradas a excluir","rafax-cluster"),onChange:e=>{const t=e.map((e=>{const t=a.find((t=>o(t.title.raw)===o(e)));return t?t.id:null})).filter(Boolean);r({excludePosts:t})},__nextHasNoMarginBottom:!0}),"2"===m&&"post"===H&&(0,t.createElement)(p,{categories:e,label:__("Categoría","rafax-cluster"),attributes:l,defaultItem:{label:__("Todas las Categorías","rafax-cluster"),value:"all"},value:M,onChange:e=>r({category:e})}),(0,t.createElement)(C,{label:__("Ordenar por","rafax-cluster"),value:y,options:[{label:"Título",value:"title"},{label:"Fecha",value:"date"},{label:"Aleatorio",value:"rand"}],onChange:e=>r({orderBy:e}),__nextHasNoMarginBottom:!0}),(0,t.createElement)(C,{label:__("Orden","rafax-cluster"),value:x,options:[{label:"Ascendente",value:"ASC"},{label:"Descendente",value:"DESC"}],onChange:e=>r({order:e}),__nextHasNoMarginBottom:!0}))),(0,t.createElement)(E,{icon:"feedback",label:__("Rafax Cluster de Entradas","rafax-cluster"),instructions:__("Selecciona las opciones para mostrar las entradas en el cluster.","rafax-cluster")},s&&(0,t.createElement)(u,{label:__("Cargando...","rafax-cluster")}),(0,t.createElement)(B,null,(0,t.createElement)(b(),{block:"rafax/cluster-entradas",skipBlockSupportAttributes:!0,attributes:l}))))})),save:()=>null});const M=(0,t.createElement)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(a.Path,{d:"M20 4H4v1.5h16V4zm-2 9h-3c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h3c1.1 0 2-.9 2-2v-3c0-1.1-.9-2-2-2zm.5 5c0 .3-.2.5-.5.5h-3c-.3 0-.5-.2-.5-.5v-3c0-.3.2-.5.5-.5h3c.3 0 .5.2.5.5v3zM4 9.5h9V8H4v1.5zM9 13H6c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h3c1.1 0 2-.9 2-2v-3c0-1.1-.9-2-2-2zm.5 5c0 .3-.2.5-.5.5H6c-.3 0-.5-.2-.5-.5v-3c0-.3.2-.5.5-.5h3c.3 0 .5.2.5.5v3z",fillRule:"evenodd",clipRule:"evenodd"})),{registerBlockType:S}=wp.blocks,{__:H}=wp.i18n,{withSelect:N}=wp.data,{Fragment:I}=wp.element,{PanelBody:T,RangeControl:z,Placeholder:O,ToggleControl:R,FormTokenField:G,Disabled:D}=wp.components,{InspectorControls:A}=wp.blockEditor;S("rafax/cluster-categorias",{title:H("Rafax Cluster de categorías","rafax-cluster"),icon:{src:M},category:"rafax-blocks",attributes:{showOnlyParent:{type:"boolean",default:!1},showParent:{type:"string",default:"0"},showImages:{type:"boolean",default:!1},numberCats:{type:"string",default:"100"},hideEmpty:{type:"boolean",default:!1},showSearch:{type:"boolean",default:!1},excludeCats:{type:"array",default:[]},showDescription:{type:"boolean",default:!1},showCount:{type:"boolean",default:!1},targetBlank:{type:"boolean",default:!1},styleGrid:{type:"string",default:"grid-cols-3"}},edit:N(((e,{clientId:t})=>{const a=e("core"),l=e("core/block-editor"),{showOnlyParent:r,excludeCats:n,hideEmpty:o,numberCats:s,showParent:c}=l.getBlock(t).attributes;let i={hide_empty:o,per_page:s>0?s:-1,exclude:n};return r&&(i.parent=0),c>0&&(i.parent=c),{categories:a.getEntityRecords("taxonomy","category",i),allCategories:a.getEntityRecords("taxonomy","category",{per_page:-1})}}))((({allCategories:e,categories:a,attributes:l,setAttributes:r})=>{const n=!a,{excludeCats:o,showImages:s,showSearch:c,numberCats:i,hideEmpty:g,showDescription:m,showCount:h,showOnlyParent:x}=l;let f=[],v=[],y=[];return null!==e&&(f=e?.map((e=>e.name))||[],v=o?.map((t=>e.find((e=>e.id===t))?.name||!1))||[],e?.map((e=>({label:e.name,value:e.id})))||[]),(0,t.createElement)(I,null,(0,t.createElement)(d,{setAttributes:r}),(0,t.createElement)(A,null,(0,t.createElement)(T,{title:H("Opciones cluster categorías","rafax-cluster"),initialOpen:!0},(0,t.createElement)(R,{label:H("Mostrar solo categorías padre","rafax-cluster"),checked:x,onChange:e=>r({showOnlyParent:e}),__nextHasNoMarginBottom:!0}),(0,t.createElement)(R,{label:H("Ocultar categorías vacias","rafax-cluster"),checked:g,onChange:e=>r({hideEmpty:e}),__nextHasNoMarginBottom:!0}),(0,t.createElement)(R,{label:H("Mostrar imagenes","rafax-cluster"),checked:s,onChange:e=>r({showImages:e}),__nextHasNoMarginBottom:!0}),(0,t.createElement)(R,{label:H("Mostrar buscador","rafax-cluster"),checked:c,onChange:e=>r({showSearch:e}),__nextHasNoMarginBottom:!0}),s&&(0,t.createElement)(I,null,(0,t.createElement)("a",{href:phpData.pSetUrl},H("Instrucciones para mostrar imagenes","rafax-cluster"))),(0,t.createElement)(z,{label:H("Numero de categorías a devolver","rafax-cluster"),value:parseInt(i),onChange:e=>r({numberCats:String(e)}),min:1,max:100,__nextHasNoMarginBottom:!0}),(0,t.createElement)(p,{categories:e,label:H("Mostrar categorías hijo de ","rafax-cluster"),help:H("Id de la categoría padre","rafax-cluster"),attributes:l,defaultItem:{label:H("Buscar categoría","rafax-cluster"),value:0},value:l.showParent,onChange:e=>r({showParent:void 0===e?"0":e}),__nextHasNoMarginBottom:!0}),(0,t.createElement)(G,{label:H("Excluir categorías","rafax-cluster"),help:H("Busca las categorías a excluir","rafax-cluster"),value:v,suggestions:f,onChange:t=>{let a=t.map((t=>{const a=e.find((e=>e.name===t));return a?a.id:null})).filter(Boolean);r({excludeCats:a})}})),(0,t.createElement)(T,{title:H("Opciones de visualizacion","rafax-cluster"),initialOpen:!0},(0,t.createElement)(R,{label:H("Abrir enlaces en una nueva ventana","rafax-cluster"),checked:l.targetBlank,onChange:e=>r({targetBlank:e}),__nextHasNoMarginBottom:!0}),(0,t.createElement)(R,{label:H("Mostrar contador de entradas","rafax-cluster"),checked:h,onChange:e=>r({showCount:e}),__nextHasNoMarginBottom:!0}),(0,t.createElement)(R,{label:H("Mostrar descripción de la categoría","rafax-cluster"),checked:m,onChange:e=>r({showDescription:e}),__nextHasNoMarginBottom:!0}))),(0,t.createElement)(O,{icon:"category",label:H("Rafax Cluster categorías","rafax-cluster"),instructions:H("Selecciona las opciones para mostrar las categorías en el cluster.","rafax-cluster")},n&&(0,t.createElement)(u,{label:H("Cargando...","rafax-cluster")}),(0,t.createElement)(D,null,(0,t.createElement)(b(),{block:"rafax/cluster-categorias",skipBlockSupportAttributes:!0,attributes:l}))))})),save:()=>null})})();