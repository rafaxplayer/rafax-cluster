(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,a=window.wp.primitives,l=(0,t.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(a.Path,{d:"m3 5c0-1.10457.89543-2 2-2h13.5c1.1046 0 2 .89543 2 2v13.5c0 1.1046-.8954 2-2 2h-13.5c-1.10457 0-2-.8954-2-2zm2-.5h6v6.5h-6.5v-6c0-.27614.22386-.5.5-.5zm-.5 8v6c0 .2761.22386.5.5.5h6v-6.5zm8 0v6.5h6c.2761 0 .5-.2239.5-.5v-6zm0-8v6.5h6.5v-6c0-.27614-.2239-.5-.5-.5z",fillRule:"evenodd",clipRule:"evenodd"})),{ToolbarGroup:r,ToolbarDropdownMenu:n,ToolbarButton:o,SelectControl:s,Spinner:c}=wp.components,{BlockControls:u}=wp.blockEditor,i=({label:e})=>(0,t.createElement)("div",{className:"rafax-cluster-spinner"},(0,t.createElement)(c,null),e),d=({setAttributes:e})=>(0,t.createElement)(u,null,(0,t.createElement)(r,null,(0,t.createElement)(n,{icon:l,label:"Estilo Grid",controls:[{title:"Grid cols 2",onClick:()=>e({styleGrid:"grid-cols-2"})},{title:"Grid cols 3",onClick:()=>e({styleGrid:"grid-cols-3"})},{title:"Grid cols 4",onClick:()=>e({styleGrid:"grid-cols-4"})}]}))),p=({categories:e,label:a,help:l,disabled:r,value:n,defaultItem:o,onChange:c})=>{let u=[];return null!==e&&(u=e.map((e=>({label:e.name,value:e.id})))),(0,t.createElement)(s,{label:a,help:l,value:n,disabled:r,options:[o,...u],onChange:c})},m=(0,t.createElement)(a.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(a.Path,{d:"m7.3 9.7 1.4 1.4c.2-.2.3-.3.4-.5 0 0 0-.1.1-.1.3-.5.4-1.1.3-1.6L12 7 9 4 7.2 6.5c-.6-.1-1.1 0-1.6.3 0 0-.1 0-.1.1-.3.1-.4.2-.6.4l1.4 1.4L4 11v1h1l2.3-2.3zM4 20h9v-1.5H4V20zm0-5.5V16h16v-1.5H4z"})),g=window.wp.serverSideRender;var h=e.n(g);const{registerBlockType:b}=wp.blocks,{withSelect:f}=wp.data,{Fragment:v}=wp.element,{__}=wp.i18n,{PanelBody:x,Spinner:w,Placeholder:y,ToggleControl:E,SelectControl:C,FormTokenField:k,Disabled:P,RangeControl:S}=wp.components,{InspectorControls:B}=wp.blockEditor;b("rafax/cluster-entradas",{title:__("Rafax Cluster Entradas","rafax-cluster"),icon:{src:m},category:"rafax-blocks",attributes:{showFeaturedImage:{type:"boolean",default:!0},includePosts:{type:"array",default:[]},excludePosts:{type:"array",default:[]},category:{type:"string",default:"all"},numberPosts:{type:"string",default:6},orderBy:{type:"string",default:"date"},order:{type:"string",default:"DESC"},styleGrid:{type:"string",default:"grid-cols-3"},typeSelect:{type:"string",default:"1"}},edit:f(((e,{clientId:t})=>{const a=e("core"),l=e("core/block-editor"),{attributes:r}=l.getBlock(t);return{categories:a.getEntityRecords("taxonomy","category",{per_page:-1}),allPosts:a.getEntityRecords("postType","post",{per_page:r.numberPosts})}}))((({categories:e,allPosts:a,attributes:l,setAttributes:r})=>{const n=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/<[^>]+>/g,"").trim(),o=!e||!a,{excludePosts:s,includePosts:c,showFeaturedImage:u,typeSelect:m,numberPosts:g,order:b,orderBy:f,category:w}=l;let I=[],z=[],O=[],R={};return null!==a&&(I=a?.map((e=>n(e.title.raw))),R=a.reduce(((e,t)=>(e[t.id]=t,e)),{}),z=s?.map((e=>{let t=R[e];return!!t&&n(t.title.raw)})),O=c?.map((e=>{let t=R[e];return!!t&&n(t.title.raw)}))),(0,t.createElement)(v,null,(0,t.createElement)(d,{setAttributes:r}),(0,t.createElement)(B,null,(0,t.createElement)(x,{title:__("Opciones","rafax-cluster"),initialOpen:!0},(0,t.createElement)(E,{label:__("Mostrar Imagen Destacada","rafax-cluster"),checked:u,onChange:e=>r({showFeaturedImage:e})}),(0,t.createElement)(C,{label:__("Tipo de seleccion","rafax-cluster"),value:m,options:[{label:"Últimas entradas",value:"1"},{label:"Entradas de una categoría",value:"2"},{label:"Elegir entradas",value:"3"}],onChange:e=>{r({includePosts:[],excludePosts:[],category:"all",numberPosts:"100"}),r({typeSelect:e})}}),"3"===m&&(0,t.createElement)(k,{label:__("Mostrar solo estas entradas","rafax-cluster"),value:O,suggestions:I,placeholder:__("Busca las entradas que quieras mostrar","rafax-cluster"),onChange:e=>{const t=e.map((e=>{const t=a.find((t=>n(t.title.raw)===n(e)));return t?t.id:null})).filter(Boolean);r({includePosts:t})}}),("1"===m||"2"===m)&&(0,t.createElement)(S,{label:__("Numero de posts","rafax-cluster"),value:parseInt(g),onChange:e=>r({numberPosts:String(e)}),min:1,max:100}),"1"===l.typeSelect&&(0,t.createElement)(k,{label:__("Excluir entradas","rafax-cluster"),value:z,suggestions:I,placeholder:__("Busca las entradas a excluir","rafax-cluster"),onChange:e=>{const t=e.map((e=>{const t=a.find((t=>n(t.title.raw)===n(e)));return t?t.id:null})).filter(Boolean);r({excludePosts:t})}}),"2"===l.typeSelect&&(0,t.createElement)(p,{categories:e,label:__("Categoría","rafax-cluster"),attributes:l,defaultItem:{label:__("Todas las Categorías","rafax-cluster"),value:"all"},value:w,onChange:e=>r({category:e})}),(0,t.createElement)(C,{label:__("Ordenar por","rafax-cluster"),value:f,options:[{label:"Título",value:"title"},{label:"Fecha",value:"date"},{label:"Aleatorio",value:"rand"}],onChange:e=>r({orderBy:e})}),(0,t.createElement)(C,{label:__("Orden","rafax-cluster"),value:b,options:[{label:"Ascendente",value:"ASC"},{label:"Descendente",value:"DESC"}],onChange:e=>r({order:e})}))),(0,t.createElement)(y,{icon:"feedback",label:__("Rafax Cluster de Entradas","rafax-cluster"),instructions:__("Selecciona las opciones para mostrar las entradas en el cluster.","rafax-cluster")},o&&(0,t.createElement)(i,{label:__("Cargando...","rafax-cluster")}),(0,t.createElement)(P,null,(0,t.createElement)(h(),{block:"rafax/cluster-entradas",skipBlockSupportAttributes:!0,attributes:l}))))})),save:()=>null});const I=(0,t.createElement)(a.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(a.Path,{d:"M20 4H4v1.5h16V4zm-2 9h-3c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h3c1.1 0 2-.9 2-2v-3c0-1.1-.9-2-2-2zm.5 5c0 .3-.2.5-.5.5h-3c-.3 0-.5-.2-.5-.5v-3c0-.3.2-.5.5-.5h3c.3 0 .5.2.5.5v3zM4 9.5h9V8H4v1.5zM9 13H6c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h3c1.1 0 2-.9 2-2v-3c0-1.1-.9-2-2-2zm.5 5c0 .3-.2.5-.5.5H6c-.3 0-.5-.2-.5-.5v-3c0-.3.2-.5.5-.5h3c.3 0 .5.2.5.5v3z",fillRule:"evenodd",clipRule:"evenodd"})),{registerBlockType:z}=wp.blocks,{__:O}=wp.i18n,{withSelect:R}=wp.data,{Fragment:M}=wp.element,{PanelBody:G,RangeControl:T,Placeholder:D,ToggleControl:A,FormTokenField:F,Disabled:_}=wp.components,{InspectorControls:V}=wp.blockEditor;z("rafax/cluster-categorias",{title:O("Rafax Cluster de categorías","rafax-cluster"),icon:{src:I},category:"rafax-blocks",attributes:{showOnlyParent:{type:"boolean",default:!1},showParent:{type:"string",default:"0"},showImages:{type:"boolean",default:!1},numberCats:{type:"string",default:"100"},hideEmpty:{type:"boolean",default:!1},showSearch:{type:"boolean",default:!1},excludeCats:{type:"array",default:[]},showDescription:{type:"boolean",default:!1},showCount:{type:"boolean",default:!1},targetBlank:{type:"boolean",default:!1},styleGrid:{type:"string",default:"grid-cols-3"}},edit:R(((e,{clientId:t})=>{const a=e("core"),l=e("core/block-editor"),{showOnlyParent:r,excludeCats:n,hideEmpty:o,numberCats:s,showParent:c}=l.getBlock(t).attributes;let u={hide_empty:o,per_page:s>0?s:-1,exclude:n};return r&&(u.parent=0),c>0&&(u.parent=c),{categories:a.getEntityRecords("taxonomy","category",u),allCategories:a.getEntityRecords("taxonomy","category",{per_page:-1})}}))((({allCategories:e,categories:a,attributes:l,setAttributes:r})=>{const n=!a,{excludeCats:o,showImages:s,showSearch:c,numberCats:u,hideEmpty:m,showDescription:g,showCount:b,showOnlyParent:f}=l;let v=[],x=[],w=[];return null!==e&&(v=e?.map((e=>e.name))||[],x=o?.map((t=>e.find((e=>e.id===t))?.name||!1))||[],e?.map((e=>({label:e.name,value:e.id})))||[]),(0,t.createElement)(M,null,(0,t.createElement)(d,{setAttributes:r}),(0,t.createElement)(V,null,(0,t.createElement)(G,{title:O("Opciones cluster categorías","rafax-cluster"),initialOpen:!0},(0,t.createElement)(A,{label:O("Mostrar solo categorías padre","rafax-cluster"),checked:f,onChange:e=>r({showOnlyParent:e})}),(0,t.createElement)(A,{label:O("Ocultar categorías vacias","rafax-cluster"),checked:m,onChange:e=>r({hideEmpty:e})}),(0,t.createElement)(A,{label:O("Mostrar imagenes","rafax-cluster"),checked:s,onChange:e=>r({showImages:e})}),(0,t.createElement)(A,{label:O("Mostrar buscador","rafax-cluster"),checked:c,onChange:e=>r({showSearch:e})}),s&&(0,t.createElement)(M,null,(0,t.createElement)("a",{href:phpData.pSetUrl},O("Instrucciones para mostrar imagenes","rafax-cluster"))),(0,t.createElement)(T,{label:O("Numero de categorías a devolver","rafax-cluster"),value:parseInt(u),onChange:e=>r({numberCats:String(e)}),min:1,max:100}),(0,t.createElement)(p,{categories:e,label:O("Mostrar categorías hijo de ","rafax-cluster"),help:O("Id de la categoría padre","rafax-cluster"),attributes:l,defaultItem:{label:O("Buscar categoría","rafax-cluster"),value:0},value:l.showParent,onChange:e=>r({showParent:void 0===e?"0":e})}),(0,t.createElement)(F,{label:O("Excluir categorías","rafax-cluster"),help:O("Busca las categorías a excluir","rafax-cluster"),value:x,suggestions:v,onChange:t=>{let a=t.map((t=>{const a=e.find((e=>e.name===t));return a?a.id:null})).filter(Boolean);r({excludeCats:a})}})),(0,t.createElement)(G,{title:O("Opciones de visualizacion","rafax-cluster"),initialOpen:!0},(0,t.createElement)(A,{label:O("Abrir enlaces en una nueva ventana","rafax-cluster"),checked:l.targetBlank,onChange:e=>r({targetBlank:e})}),(0,t.createElement)(A,{label:O("Mostrar contador de entradas","rafax-cluster"),checked:b,onChange:e=>r({showCount:e})}),(0,t.createElement)(A,{label:O("Mostrar descripción de la categoría","rafax-cluster"),checked:g,onChange:e=>r({showDescription:e})}))),(0,t.createElement)(D,{icon:"category",label:O("Rafax Cluster categorías","rafax-cluster"),instructions:O("Selecciona las opciones para mostrar las categorías en el cluster.","rafax-cluster")},n&&(0,t.createElement)(i,{label:O("Cargando...","rafax-cluster")}),(0,t.createElement)(_,null,(0,t.createElement)(h(),{block:"rafax/cluster-categorias",skipBlockSupportAttributes:!0,attributes:l}))))})),save:()=>null})})();